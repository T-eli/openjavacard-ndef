/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * To learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.5/samples
 */

buildscript {
    repositories {
        jcenter()
        mavenCentral()

        maven { url "https://javacard.pro/maven" }
        maven { url "https://deadcode.me/mvn" }
    }
    dependencies {
        classpath 'com.klinec:gradle-javacard:1.8.0'
    }
}

def localProperties = new Properties()
def localPropertiesFile = rootProject.file('local.properties')
if (localPropertiesFile.exists()) {
    localPropertiesFile.withInputStream { localProperties.load(it) }
}

ext.localProperties = localProperties

ext {
    jcHome = rootProject.file(localProperties.getProperty('jc.path', System.getenv('JC_HOME'))).absolutePath
    defaultKey = localProperties.getProperty('jc.defaultKey')
}

allprojects {
    apply plugin: 'groovy'
    group 'org.openjavacard'

    sourceCompatibility = 1.8

    repositories {
        mavenCentral()

        maven { url "https://dl.bintray.com/ph4r05/jcard" }
        maven { url "https://javacard.pro/maven" }
        maven { url "https://deadcode.me/mvn" }
    }

    project.buildDir rootProject.buildDir
}


subprojects {
    if (project.name.startsWith('applet-')) {

        apply plugin: "com.klinec.gradle.javacard"
        ext.variant = project.name.substring('applet-'.length())
        afterEvaluate {
            tasks.named('listJavaCard').configure {
                doFirst {
                    args = args + ['-r', localProperties.get('jc.reader')]
                }
            }

        }
    }
}